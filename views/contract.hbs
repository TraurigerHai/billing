<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/style.css">
    <link type="image/x-icon" href="/img/favicon.svg" rel="shortcut icon">
    <link type="Image/x-icon" href="/img/favicon.svg" rel="icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
        rel="stylesheet">
    <title>–ù–æ–≤—ã–π</title>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
</head>

<body>
    <div class="main-container">
        <header class="header">
            <nav class="menu">
                <div class="menu-item">
                    <a href="/main">
                        <div class="menu-icon">‚åÇ</div>
                        <span>–ì–ª–∞–≤–Ω–∞—è</span>
                    </a>
                </div>
                <div class="menu-item active">
                    <a href="/contract">
                        <div class="menu-icon">üìÑ</div>
                        <span>–î–æ–≥–æ–≤–æ—Ä—ã</span>
                    </a>
                </div>
                <div class="menu-item">
                    <a href="/search">
                        <div class="menu-icon">üîç</div>
                        <span>–ü–æ–∏—Å–∫</span>
                    </a>
                </div>
                <div class="menu-item">
                    <a href="/server">
                        <div class="menu-icon">‚öôÔ∏è</div>
                        <span>–°–µ—Ä–≤–µ—Ä</span>
                    </a>
                </div>
                <div class="menu-item">
                    <a href="/user">
                        <div class="menu-icon">üë§</div>
                        <span>{{username}}</span>
                    </a>
                </div>
            </nav>
        </header>

        <main class="content">
            <div class="main-grid">
                <section class="summary-section">
                    <div class="section-header">
                        <div class="header-icon">üìã</div>
                        <h2>–ù–∞–≤–∏–≥–∞—Ü–∏—è</h2>
                    </div>
                    <div class="navigation-cards">
                        <a href="/contract?section=1{{#if contractNumber}}&contract_number={{encodeURIComponent contractNumber}}{{/if}}" 
                           class="summary-card {{#if (eq activeSection '1')}}active{{/if}}">
                            <div class="card-icon">üìÑ</div>
                            <div class="card-content">
                                <p>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–æ–≥–æ–≤–æ—Ä–∞</p>
                            </div>
                        </a>
                        {{#if contractNumber}}
                        <a href="/contract?section=2&contract_number={{encodeURIComponent contractNumber}}" 
                           class="summary-card {{#if (eq activeSection '2')}}active{{/if}}">
                            <div class="card-icon">üí∞</div>
                            <div class="card-content">
                                <p>–ë–∞–ª–∞–Ω—Å</p>
                            </div>
                        </a>
                        <a href="/contract?section=3&contract_number={{encodeURIComponent contractNumber}}" 
                           class="summary-card {{#if (eq activeSection '3')}}active{{/if}}">
                            <div class="card-icon">üìä</div>
                            <div class="card-content">
                                <p>–¢–∞—Ä–∏—Ñ–Ω—ã–π –ø–ª–∞–Ω</p>
                            </div>
                        </a>
                        {{/if}}
                    </div>
                </section>

                <section class="notifications-section">
                    {{#if (eq activeSection '1')}}
                    <div class="section-header">
                        <div class="card-icon">üìÑ</div>
                        <h2>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–æ–≥–æ–≤–æ—Ä–∞</h2>
                    </div>
                    <div class="form-card">
                        <form method="POST" action="/save" class="contract-form">
                            <div class="contract_item">
                                <label>–ù–æ–º–µ—Ä –¥–æ–≥–æ–≤–æ—Ä–∞:</label>
                                <input name="contract_number" value="{{contractNumber}}" readonly>
                            </div>
                            <div class="contract_item">
                                <label>–§–ò–û:</label>
                                <input name="full_name" value="{{full_name}}">
                            </div>
                            <div class="contract_item">
                                <label>–¢–µ–ª–µ—Ñ–æ–Ω:</label>
                                <input name="phone" value="{{phone}}" class="masked-phone">
                            </div>
                            <div class="contract_item">
                                <label>–ê–¥—Ä–µ—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:</label>
                                <input name="connection_address" value="{{connection_address}}">
                            </div>
                            <div class="contract_item">
                                <label>–ê–¥—Ä–µ—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</label>
                                <input name="registration_address" value="{{registration_address}}">
                            </div>
                            <div class="contract_item">
                                <label>–¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞:</label>
                                <input name="document_type" value="{{document_type}}">
                            </div>
                            <div class="contract_item">
                                <label>–°–µ—Ä–∏—è:</label>
                                <input name="document_series" value="{{document_series}}" class="masked-series">
                            </div>
                            <div class="contract_item">
                                <label>–ù–æ–º–µ—Ä:</label>
                                <input name="document_number" value="{{document_number}}" class="masked-number">
                            </div>
                            <div class="contract_item">
                                <label>–ö–µ–º –≤—ã–¥–∞–Ω:</label>
                                <input name="issued_by" value="{{issued_by}}">
                            </div>
                            <div class="contract_item">
                                <label>–î–∞—Ç–∞ –≤—ã–¥–∞—á–∏:</label>
                                <input name="issue_date" value="{{issue_date}}" class="masked-date">
                            </div>
                            <div class="contract_item">
                                <label>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:</label>
                                <input name="birth_date" value="{{birth_date}}" class="masked-date">
                            </div>
                            <div class="contract_item">
                                <label>–°—Ç–∞—Ç—É—Å –¥–æ–≥–æ–≤–æ—Ä–∞:</label>
                                <select name="contract_status">
                                    <option value="–û–∂–∏–¥–∞–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è" {{#if (eq contract_status "–û–∂–∏–¥–∞–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è")}}selected{{/if}}>–û–∂–∏–¥–∞–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</option>
                                    <option value="–ê–∫—Ç–∏–≤–Ω—ã–π" {{#if (eq contract_status "–ê–∫—Ç–∏–≤–Ω—ã–π")}}selected{{/if}}>–ê–∫—Ç–∏–≤–Ω—ã–π</option>
                                    <option value="–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω" {{#if (eq contract_status "–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")}}selected{{/if}}>–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</option>
                                </select>
                            </div>
                            <div class="contract_item">
                                <label>–î–∞—Ç–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è:</label>
                                <input name="contract_date" value="{{contract_date}}" class="masked-date">
                            </div>
                            <div class="contract_item">
                                <label>–î–∞—Ç–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:</label>
                                <input name="actual_connection_date" value="{{actual_connection_date}}" class="masked-date">
                            </div>
                            <button type="submit" class="action-button">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                        </form>
                    </div>
                    {{/if}}

                    {{#if (eq activeSection '2')}}
                    <div class="section-header">
                        <div class="card-icon">üí∞</div>
                        <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–æ–º</h2>
                    </div>
                    <div class="balance-section">
                        <div class="summary-card">
                            <div class="card-icon">üí∞</div>
                            <div class="card-content">
                                <p>–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å</p>
                                <strong>{{balance}} ‚ÇΩ</strong>
                            </div>
                        </div>
                        
                        <div class="form-card">
                            <form method="POST" action="/contract" class="deposit-form">
                                <input type="number" name="deposit_amount" class="search_input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" min="0.01" step="0.01">
                                <input type="hidden" name="contract_number" value="{{contractNumber}}">
                                <button type="submit" class="action-button">–í–Ω–µ—Å—Ç–∏</button>
                            </form>
                        </div>
                    </div>
                    {{/if}}

                    {{#if (eq activeSection '3')}}
                    <div class="section-header">
                        <div class="card-icon">üìä</div>
                        <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–æ–º</h2>
                    </div>
                    <div class="tariff-section">
                        <div class="form-card">
                            <form method="POST" action="/update-tariff">
                                <select name="tariff_id" class="field-input">
                                    {{#each tariffPlans}}
                                    <option value="{{id}}" {{#if (eq ../currentTariffId id)}}selected{{/if}}>
                                        {{name}} - {{price}} ‚ÇΩ/–º–µ—Å
                                    </option>
                                    {{/each}}
                                </select>
                                <input type="hidden" name="contract_number" value="{{contractNumber}}">
                                <button type="submit" class="action-button">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                            </form>
                        </div>
                    </div>
                    {{/if}}
                </section>
            </div>
        </main>
    </div>
    <script>
        $(document).ready(function() {
            $('.masked-phone').mask('+70000000000');
            $('.masked-series').mask('0000');
            $('.masked-number').mask('000000');
            $('.masked-date').mask('00.00.0000', {
                placeholder: "–î–î.–ú–ú.–ì–ì–ì–ì"
            });
        });
    </script>
</body>

</html>